---
active_crumb: Setting Up
layout: documentation
---

<!--
   “Commons Clause” License, https://commonsclause.com/

   The Software is provided to you by the Licensor under the License,
   as defined below, subject to the following condition.

   Without limiting other conditions in the License, the grant of rights
   under the License will not include, and the License does not grant to
   you, the right to Sell the Software.

   For purposes of the foregoing, “Sell” means practicing any or all of
   the rights granted to you under the License to provide to third parties,
   for a fee or other consideration (including without limitation fees for
   hosting or consulting/support services related to the Software), a
   product or service whose value derives, entirely or substantially, from
   the functionality of the Software. Any license notice or attribution
   required by the License must also include this Commons Clause License
   Condition notice.

   Software:    NLPCraft
   License:     Apache 2.0, https://www.apache.org/licenses/LICENSE-2.0
   Licensor:    Copyright (C) 2018 DataLingvo, Inc. https://www.datalingvo.com

       _   ____      ______           ______
      / | / / /___  / ____/________ _/ __/ /_
     /  |/ / / __ \/ /   / ___/ __ `/ /_/ __/
    / /|  / / /_/ / /___/ /  / /_/ / __/ /_
   /_/ |_/_/ .___/\____/_/   \__,_/_/  \__/
          /_/
-->

<div class="col-md-8 second-column">
    <section id="setup">
        <span class="section-title">Project Setup</span>
        <p>
            Let's setup a project for our first example. To simplify this task we'll make certain assumptions:
        </p>
        <ul>
            <li>We'll assume Mac OS/Linux environment</li>
            <li>We'll use <a target=_new href="https://www.oracle.com/technetwork/java/javase/downloads/index.html">Java</a> to implement our model</li>
            <li>We'll use <a target=_ href="https://maven.apache.org/install.html">Maven</a> to create and build our project</li>
            <li>We'll use <a target=_ href="https://www.jetbrains.com/idea/">JetBrains IDEA</a> as our Java IDE</li>
        </ul>
        <div class="bq info">
            Note that following instructions will work for most OS, JVM languages or
            IDE/text editors with minimal, if any, modifications.
        </div>
    </section>
    <section id="new_project">
        <span class="section-sub-title">Create New Project</span>
        <p>
            We'll use maven archetype generation to create new empty Java project. In your home folder run the following
            command:
        </p>
        <pre class="brush: text">
            mvn archetype:generate -DgroupId=examples -DartifactId=my-app -DarchetypeVersion=1.4 -DinteractiveMode=false
        </pre>
        <p>
            This will create <code>my-app</code> folder with the following default maven project structure:
        </p>
        <pre class="console">
$ cd my-app/
$ tree
.
├── <b>pom.xml</b>
└── src
    ├── main
    │   └── java
    │       └── examples
    │           └── App.java
    └── test
        └── java
            └── examples
                └── AppTest.java
        </pre>
    </section>
    <section id="new_ide_project">
        <span class="section-sub-title">New IDE Project</span>
        <p>
            Once we have maven-based project we can import it into our IDE. Details are specific for each IDE but
            for our choice of JetBrains IDEA click on <code>File > New > Project from Existing Sources...</code> menu
            and select <code>pom.xml</code> file from the project we just created above.
            Follow all the steps on the project creation wizard (default settings should be fine). Make sure to select
            JDK 8 or later as your Java JDK as well as project language level as 8 or above. After you followed through all the steps you should have the project with
            the structure looking similar to this:
        </p>
        <figure class="alt">
            <img class="img-fluid" src="/images/new_idea_project1.png">
            <figcaption><b>Fig 1.</b> Project Structure</figcaption>
        </figure>
    </section>
    <section id="add_nlpcraft">
        <span class="section-sub-title">Add NLPCraft</span>
        <p>
            Finally we'll add NLPCraft dependency to our new project. Open <code>pom.xml</code> file and replace
            <code>dependencies</code> section with the following code:
        </p>
        <pre class="brush: xml, highlight: [3, 4, 5]">
            &lt;dependencies&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;org.nlpcraft&lt;/groupId&gt;
                    &lt;artifactId&gt;nlpcraft&lt;/artifactId&gt;
                    &lt;version&gt;{{site.latest_version}}&lt;/version&gt;
                &lt;/dependency&gt;
            &lt;/dependencies&gt;
        </pre>
        <p>
            Also make sure that you have correct JDK version (1.8 or above) for the maven compiler plugin:
        </p>
        <pre class="brush: xml, highlight: [3, 4]">
            &lt;properties&gt;
                &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
                &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
                &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
            &lt;/properties&gt;
        </pre>
        <p>
            IDEA should automatically reload the project with newly updated <code>pom.xml</code> file and
            we should be ready now to develop our new first data model.
        </p>
    </section>
    <section id="data_model">
        <span class="section-title">First Data Model</span>
        <p>
            For our first data model we'll develop an alarm clock with a natural language interface. This would be
            similar to <a target="github" href="https://github.com/vic64/nlpcraft/tree/master/src/main/scala/org/nlpcraft/examples/alarm">Alarm Clock</a> example
            available in NLPCraft - but we'll build it from scratch here.
        </p>
        <div class="bq info">
            <p>
                Note that we'll explain many technical details in later chapters while concentrating here
                on high level project and code organization.
            </p>
        </div>
        <p>
            In NLPCraft a data model is simply an implementation of <a target="javadoc" href="http://127.0.0.1:4000/apis/latest/org/nlpcraft/model/NCModel.html">NCModel</a>
            interface. You can implement this interface in many ways but we recommend to use
            <a target="javadoc" href="http://127.0.0.1:4000/apis/latest/org/nlpcraft/model/builder/NCModelBuilder.html">NCModelBuilder</a> class with external JSON/YAML definition for the static
            part of the model. This way you cleanly separate the logic of the model from its declarative configuration.
        </p>
        <p>
            Let's add new <code>alarm_model.json</code> file containing model's static configuration in JSON
            along sides the auto-generated <code>App.java</code> with the following content:
        </p>
        <pre class="brush: js, highlight: [2, 18, 19, 20, 21, 22, 23]">
            {
                "id": "nlpcraft.alarm.ex",
                "name": "Alarm Example Model",
                "version": "1.0",
                "description": "Alarm example model.",
                "vendorName": "NLPCraft",
                "vendorUrl": "https://www.nlpcraft.org",
                "vendorContact": "Support",
                "vendorEmail": "info@nlpcraft.org",
                "docsUrl": "https://www.nlpcraft.org",
                "examples": [
                    "Ping me in 3 minutes",
                    "Buzz me in an hour and 15mins",
                    "Set my alarm for 30s"
                ],
                "elements": [
                    {
                        "id": "x:alarm",
                        "description": "Alarm token indicator.",
                        "synonyms": [
                            "{ping|buzz|wake|call|hit} {me|up|me up|*}",
                            "{set|*} {my|*} {wake|wake up|*} {morning|evening|*} {alarm|timer|alarm clock|buzzer|call} {up|*}"
                        ]
                    }
                ]
            }
        </pre>
        <p>
            Note the model ID <code>nlpcraft.alarm.ex</code> as well as one semantic model element <code>x:alarm</code>
            both of which we'll use later. Model element <code>x:alarm</code> defines a textual (or speech) indicator
            that we are asking about setting up the alarm clock. It consists of the ID and a set of synonyms written
            in a special macro expression language.
        </p>
        <p>
            Next let's go ahead and add model's logic. Rename <code>App.java</code> to <code>AlarmModel.java</code>
            and copy the following model code into it:
        </p>
        <pre class="brush: java">
package examples;

import org.nlpcraft.model.*;
import org.nlpcraft.model.builder.*;
import org.nlpcraft.model.intent.*;
import org.nlpcraft.model.intent.NCIntentSolver.*;
import org.nlpcraft.model.utils.*;
import java.time.*;
import java.time.format.*;
import java.util.*;

import static java.time.temporal.ChronoUnit.*;
import static org.nlpcraft.model.utils.NCTokenUtils.*;

public class AlarmModel extends NCModelProviderAdapter {
    private static final DateTimeFormatter FMT =
        DateTimeFormatter.ofPattern("HH'h' mm'm' ss's'")
            .withZone(ZoneId.systemDefault());

    private final Timer timer = new Timer();

    public AlarmModel() {
        NCIntentSolver solver = new NCIntentSolver();

        solver.addIntent(
            new NON_CONV_INTENT(
                "x:alarm|num{1+}",
                new TERM("id == x:alarm", 1, 1),
                new TERM(
                    new AND(
                        "id == nlp:num",
                        "~NUM_UNITTYPE == datetime",
                        "~NUM_ISEQUALCONDITION == true"
                    ),
                    0,
                    7
                )
            ),
            this::onMatch
        );

        setup(NCModelBuilder.newJsonModel(
            AlarmModel.class.getClassLoader()
                .getResourceAsStream("examples/alarm_model.json"))
            .setQueryFunction(solver::solve)
            .build()
        );
    }

    private NCQueryResult onMatch(NCIntentSolverContext ctx) {
        if (!ctx.isExactMatch())
            throw new NCRejection("Not exact match.");

        List&lt;NCToken&gt; nums = ctx.getIntentTokens().get(1);

        long unitsCnt = nums.stream().map(NCTokenUtils::getNumUnit)
            .distinct().count();

        if (unitsCnt != nums.size())
            throw new NCRejection("Ambiguous time units.");

        LocalDateTime now = LocalDateTime.now();
        LocalDateTime dt = now;

        for (NCToken num : nums) {
            String unit = getNumUnit(num);

            // Skips possible fractional to simplify.
            long v = (long)getNumFrom(num);

            if (v <= 0)
                throw new NCRejection("Value must be positive: " + unit);

            switch (unit) {
                case "second": { dt = dt.plusSeconds(v); break; }
                case "minute": { dt = dt.plusMinutes(v); break; }
                case "hour": { dt = dt.plusHours(v); break; }
                case "day": { dt = dt.plusDays(v); break; }
                case "week": { dt = dt.plusWeeks(v); break; }
                case "month": { dt = dt.plusMonths(v); break; }
                case "year": { dt = dt.plusYears(v); break; }

                default:
                    throw new NCRejection("Unsupported time unit: " + unit);
            }
        }

        long ms = now.until(dt, MILLIS);

        assert ms >= 0;

        timer.schedule(
            new TimerTask() {
                @Override
                public void run() {
                    System.out.println(
                        "BEEP BEEP BEEP for: " +
                            ctx.getQueryContext().getSentence().getNormalizedText()
                    );
                }
            },
            ms
        );

        return NCQueryResult.text("Timer set for: " + FMT.format(dt));
    }
}
        </pre>
    </section>
</div>
<div class="col-md-2 third-column">
    <ul class="side-nav">
        <li class="side-nav-title">On This Page</li>
        <li><a href="#setup">Project Setup</a></li>
        <li><a href="#data_model">First Data Model</a></li>
        <li class="side-nav-title">Quick Links</li>
        <li>
            <img class="quick-link-img mr-2" src="/images/github_logo.png"><a
            target="github"
            href="https://github.com/vic64/nlpcraft/tree/master/src/main/scala/org/nlpcraft/examples">Examples</a>
        </li>
        <li>
            <img class="quick-link-img mr-2" src="/images/java.png"><a
            target="javadoc"
            href="/apis/latest/index.html">Javadoc</a>
        </li>
        <li>
            <img class="quick-link-img mr-2" src="/images/apiary.svg"><a
            href="https://nlpcraft.docs.apiary.io"
            target="apiary">REST API</a>
        </li>
        <li>
            <i class="fas fa-download mr-2"></i><a href="/download">Download</a>
        </li>
        <li class="side-nav-title">Support</li>
        <li>
            <nobr>
                <i class="far fa-fw fa-envelope mr-2"></i><a href="mailto:support@nlpcraft.org">Email</a>
            </nobr>
        </li>
        <li>
            <nobr>
                <i class="fab fa-fw fa-stack-overflow mr-2"></i><a target="so" href="https://stackoverflow.com/questions/ask">Stack Overflow</a>
            </nobr>
        </li>
        <li>
            <nobr>
                <i class="fab fa-fw fa-github mr-2"></i><a target="github" href="https://github.com/vic64/nlpcraft/issues">GitHub</a>
            </nobr>
        </li>
    </ul>
</div>




